#define _USE_MATH_DEFINES 1

#include "analog_eq.h"

#if RUN_BENCH
#include <xsimd/xsimd.hpp>
#include "../performance_counters/event_counter.h"
#endif

#include "../chowdsp_wdf.h"
#include <iostream>
#include <fstream>
#include <random>

namespace wdft = chowdsp::wdft;

// Reference: https://www.gyraf.dk/gy_pd/pultec/pultech.gif
class Reference_WDF
{
public:
    /** WDF Inductor Node with some saturating nonlinear behaviour */
    template <typename T>
    class NonlinearInductorT final : public wdft::BaseWDF
    {
        public:
        explicit NonlinearInductorT (T value, T fs = (T) 48000.0) : L_value (value),
                                                                    fs (fs)
        {
            calcImpedance();
        }

        void prepare (T sampleRate)
        {
            fs = sampleRate;
            propagateImpedanceChange();

            reset();
        }

        void reset()
        {
            z = (T) 0.0;
        }

        void setInductanceValue (T newL)
        {
            if (newL == L_value)
                return;

            L_value = newL;
            propagateImpedanceChange();
        }

        inline void calcImpedance() override
        {
            wdf.R = (T) 2.0 * L_value * fs;
            wdf.G = (T) 1.0 / wdf.R;
        }

        inline void incident (T x) noexcept
        {
            wdf.a = x;
            z = wdf.a / (std::sqrt (wdf.a * wdf.a + 1.0f));
        }

        inline T reflected() noexcept
        {
            wdf.b = -z;
            return wdf.b;
        }

        wdft::WDFMembers<T> wdf;

        private:
        T L_value = (T) 1.0e-6;
        T z = (T) 0.0;

        T fs;
    };

    void prepare (float sampleRate)
    {
        C_treble_boost.prepare (sampleRate);
        L_treble_boost.prepare (sampleRate);
        C_low_boost.prepare (sampleRate);
        C_treble_cut.prepare (sampleRate);
        C_low_cut.prepare (sampleRate);
    }

    void setParameters (float treble_boost, float treble_boost_q, float treble_boost_freq, float treble_cut, float treble_cut_freq, float low_boost, float low_cut, float bass_freq)
    {
        // see sim/pultec_bass_freq_curve_fit.py
        P_low_cut.setResistanceValue (1.0f + std::pow (low_cut, 1.443f) * 99.999e3f);
        P_low_boost.setResistanceValue (1.0f + std::pow (low_boost, 2.587f) * 9.999e3f);
        const auto bass_boost_cap_val = 1.0f / (2.0f * M_PI * 1.13062281e+04f * (bass_freq - 1.30692349e+01f)) + 1.68909808e-07f;
        const auto bass_cut_cap_val = 1.0f / (2.0f * M_PI * 2.27142549e+05f * (bass_freq - 1.24565293e+01f)) + 7.10814416e-09f;
        C_low_boost.setCapacitanceValue (bass_boost_cap_val);
        C_low_cut.setCapacitanceValue (bass_cut_cap_val);

        const auto treble_cut_skew = std::pow (treble_cut, 0.395f);
        P_treble_cut_plus.setResistanceValue (1.0e3f * (1.0f - treble_cut_skew));
        P_treble_cut_minus.setResistanceValue (1.0e3f * treble_cut_skew);
        const auto treble_cut_cap_val = 1.0f / (2.0f * M_PI * 169.3f * treble_cut_freq);
        C_treble_cut.setCapacitanceValue (treble_cut_cap_val);

        const auto treble_boost_skew = std::pow (treble_boost, 0.621f);
        P_treble_boost_plus.setResistanceValue (10.0e3f * (1.0f - treble_boost_skew));
        P_treble_boost_minus.setResistanceValue (10.0e3f * treble_boost_skew);
        R_treble_boost_bw.setResistanceValue (1.0f + (1.0f - treble_boost_q) * 2499.0f);

        // see sim/pultec_treble_boost_freq_curve_fit.py
        const auto A_r = std::sqrt (1.0e7f);
        const auto g_val = 9.75043069e-05f + treble_boost_freq * (-2.05889893e-08f + treble_boost_freq * (1.73050404e-12f + treble_boost_freq * -4.96665892e-17f));
        const auto treble_boost_cap_val = g_val / A_r;
        const auto treble_boost_ind_val = A_r * A_r * treble_boost_cap_val;
        C_treble_boost.setCapacitanceValue (treble_boost_cap_val);
        L_treble_boost.setInductanceValue (treble_boost_ind_val);
    }

    inline float process (float x) noexcept
    {
        Vin.setVoltage (x);

        Vin.incident (Pvin.reflected());
        Pvin.incident (Vin.reflected());

        return wdft::voltage<float> (Rload);
    }

private:
    // Port B
    wdft::ResistorT<float> P_low_cut { 100.0e3f };
    wdft::CapacitorT<float> C_low_cut { 0.012e-6f }; // 100 Hz
    wdft::WDFParallelT<float, decltype (P_low_cut), decltype (C_low_cut)> Pb { P_low_cut, C_low_cut };
    wdft::ResistorT<float> Rlc { 1.0e3f };
    wdft::WDFSeriesT<float, decltype (Pb), decltype (Rlc)> Sb { Pb, Rlc };

    // Port C
    wdft::ResistorT<float> P_treble_cut_plus { 500.0f };

    // Port D
    wdft::ResistorT<float> Rc { 75.0f };
    wdft::CapacitorT<float> C_treble_cut { 0.068e-6f }; // 20 kHz
    wdft::WDFSeriesT<float, decltype (Rc), decltype (C_treble_cut)> Streble_cut { Rc, C_treble_cut };
    wdft::ResistorT<float> P_treble_cut_minus { 500.0f };
    wdft::WDFParallelT<float, decltype (Streble_cut), decltype (P_treble_cut_minus)> Ptreble_cut { Streble_cut, P_treble_cut_minus };

    // Port E
    wdft::ResistorT<float> P_low_boost { 9.0e3f };
    wdft::CapacitorT<float> C_low_boost { 0.33e-6f }; // 100Hz
    wdft::WDFParallelT<float, decltype (P_low_boost), decltype (C_low_boost)> Pbass_boost { P_low_boost, C_low_boost };

    // Port F
    wdft::ResistorT<float> Rb { 10.0e3f };

    // Port G
    wdft::ResistorT<float> Rload { 1.0e6f };

    // R-Type
    struct ImpedanceCalc
    {
        template <typename RType>
        static float calcImpedance (RType& R)
        {
            const auto [Rb, Rc, Rd, Re, Rf, Rg] = R.getPortImpedances();

            // This scattering matrix was derived using the R-Solver python script (https://github.com/jatinchowdhury18/R-Solver),
            // invoked with command: r_solver.py --adapt 5 --out scratch/common_cathode_scatt.txt scratch/common_cathode.txt
            R.setSMatrixData ({ { 0, -((Rc + Rd) * Re + (Rc + Rd + Re) * Rf + (Rc + Rd) * Rg) / ((Rb + Rc + Rd) * Re + (Rb + Rc + Rd + Re) * Rf + (Rb + Rc + Rd + Rf) * Rg), -(Rb * Re + Rb * Rf + (Rb + Rf) * Rg) / ((Rb + Rc + Rd) * Re + (Rb + Rc + Rd + Re) * Rf + (Rb + Rc + Rd + Rf) * Rg), -(Rb * Re + Rb * Rf + (Rb + Rf) * Rg) / ((Rb + Rc + Rd) * Re + (Rb + Rc + Rd + Re) * Rf + (Rb + Rc + Rd + Rf) * Rg), -(Rb * Rf + (Rb + Rc + Rd + Rf) * Rg) / ((Rb + Rc + Rd) * Re + (Rb + Rc + Rd + Re) * Rf + (Rb + Rc + Rd + Rf) * Rg), (Rb * Re - (Rc + Rd) * Rg) / ((Rb + Rc + Rd) * Re + (Rb + Rc + Rd + Re) * Rf + (Rb + Rc + Rd + Rf) * Rg), -((Rb + Rc + Rd) * Re + (Rc + Rd + Re) * Rf) / ((Rb + Rc + Rd) * Re + (Rb + Rc + Rd + Re) * Rf + (Rb + Rc + Rd + Rf) * Rg) },
                                { -((Rb * Rc + Rb * Rd) * Re + (Rb * Rc + Rb * Rd + Rb * Re) * Rf + (Rb * Rc + Rb * Rd) * Rg) / ((Rb * Rc + Rb * Rd) * Re + (Rb * Rc + Rb * Rd + Rb * Re) * Rf + (Rb * Rc + Rb * Rd + (Rb + Rc + Rd) * Re + (Rc + Rd + Re) * Rf) * Rg), -((Rb * Rb * Rc + Rb * Rb * Rd) * Re * Re + (Rb * Rb * Rc + Rb * Rb * Rd + Rb * Rb * Re) * Rf * Rf + (Rb * Rb * Rc + Rb * Rb * Rd - (Rc + Rd + Re) * Rf * Rf + (Rb * Rb - Rc * Rc - 2 * Rc * Rd - Rd * Rd) * Re - (Rc * Rc + 2 * Rc * Rd + Rd * Rd + 2 * (Rc + Rd) * Re) * Rf) * Rg * Rg + (Rb * Rb * Re * Re + 2 * (Rb * Rb * Rc + Rb * Rb * Rd) * Re) * Rf + ((Rb * Rb - Rc * Rc - 2 * Rc * Rd - Rd * Rd) * Re * Re - (Rc * Rc + 2 * Rc * Rd + Rd * Rd + 2 * (Rc + Rd) * Re + Re * Re) * Rf * Rf + 2 * (Rb * Rb * Rc + Rb * Rb * Rd) * Re + 2 * (Rb * Rb * Rc + Rb * Rb * Rd - (Rc + Rd) * Re * Re + (Rb * Rb - Rc * Rc - 2 * Rc * Rd - Rd * Rd) * Re) * Rf) * Rg) / ((Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb * Rb + 2 * Rb * Rc) * Rd) * Re * Re + (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + Rb * Re * Re + (Rb * Rb + 2 * Rb * Rc) * Rd + (Rb * Rb + 2 * Rb * Rc + 2 * Rb * Rd) * Re) * Rf * Rf + (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rc + Rd + Re) * Rf * Rf + (Rb * Rb + 2 * Rb * Rc) * Rd + (Rb * Rb + 2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd) * Re + (2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd + 2 * (Rb + Rc + Rd) * Re) * Rf) * Rg * Rg + ((Rb * Rb + 2 * Rb * Rc + 2 * Rb * Rd) * Re * Re + 2 * (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb * Rb + 2 * Rb * Rc) * Rd) * Re) * Rf + ((Rb * Rb + 2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd) * Re * Re + (2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd + 2 * (Rb + Rc + Rd) * Re + Re * Re) * Rf * Rf + 2 * (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb * Rb + 2 * Rb * Rc) * Rd) * Re + 2 * (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb + Rc + Rd) * Re * Re + (Rb * Rb + 2 * Rb * Rc) * Rd + (Rb * Rb + 3 * Rb * Rc + Rc * Rc + (3 * Rb + 2 * Rc) * Rd + Rd * Rd) * Re) * Rf) * Rg), ((Rb * Rb * Rc + Rb * Rb * Rd) * Re * Re + (Rb * Rb * Rc + Rb * Rb * Rd + Rb * Rb * Re) * Rf * Rf + (Rb * Rb * Rc + Rb * Rb * Rd + 2 * (Rb * Rb + Rb * Rc + Rb * Rd) * Re + (Rb * Rc + Rb * Rd + 2 * Rb * Re) * Rf) * Rg * Rg + (Rb * Rb * Re * Re + 2 * (Rb * Rb * Rc + Rb * Rb * Rd) * Re) * Rf + (2 * (Rb * Rb + Rb * Rc + Rb * Rd) * Re * Re + (Rb * Rc + Rb * Rd + Rb * Re) * Rf * Rf + 2 * (Rb * Rb * Rc + Rb * Rb * Rd) * Re + (2 * Rb * Rb * Rc + 2 * Rb * Rb * Rd + 2 * Rb * Re * Re + 3 * (Rb * Rb + Rb * Rc + Rb * Rd) * Re) * Rf) * Rg) / ((Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb * Rb + 2 * Rb * Rc) * Rd) * Re * Re + (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + Rb * Re * Re + (Rb * Rb + 2 * Rb * Rc) * Rd + (Rb * Rb + 2 * Rb * Rc + 2 * Rb * Rd) * Re) * Rf * Rf + (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rc + Rd + Re) * Rf * Rf + (Rb * Rb + 2 * Rb * Rc) * Rd + (Rb * Rb + 2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd) * Re + (2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd + 2 * (Rb + Rc + Rd) * Re) * Rf) * Rg * Rg + ((Rb * Rb + 2 * Rb * Rc + 2 * Rb * Rd) * Re * Re + 2 * (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb * Rb + 2 * Rb * Rc) * Rd) * Re) * Rf + ((Rb * Rb + 2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd) * Re * Re + (2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd + 2 * (Rb + Rc + Rd) * Re + Re * Re) * Rf * Rf + 2 * (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb * Rb + 2 * Rb * Rc) * Rd) * Re + 2 * (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb + Rc + Rd) * Re * Re + (Rb * Rb + 2 * Rb * Rc) * Rd + (Rb * Rb + 3 * Rb * Rc + Rc * Rc + (3 * Rb + 2 * Rc) * Rd + Rd * Rd) * Re) * Rf) * Rg), ((Rb * Rb * Rc + Rb * Rb * Rd) * Re * Re + (Rb * Rb * Rc + Rb * Rb * Rd + Rb * Rb * Re) * Rf * Rf + (Rb * Rb * Rc + Rb * Rb * Rd + 2 * (Rb * Rb + Rb * Rc + Rb * Rd) * Re + (Rb * Rc + Rb * Rd + 2 * Rb * Re) * Rf) * Rg * Rg + (Rb * Rb * Re * Re + 2 * (Rb * Rb * Rc + Rb * Rb * Rd) * Re) * Rf + (2 * (Rb * Rb + Rb * Rc + Rb * Rd) * Re * Re + (Rb * Rc + Rb * Rd + Rb * Re) * Rf * Rf + 2 * (Rb * Rb * Rc + Rb * Rb * Rd) * Re + (2 * Rb * Rb * Rc + 2 * Rb * Rb * Rd + 2 * Rb * Re * Re + 3 * (Rb * Rb + Rb * Rc + Rb * Rd) * Re) * Rf) * Rg) / ((Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb * Rb + 2 * Rb * Rc) * Rd) * Re * Re + (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + Rb * Re * Re + (Rb * Rb + 2 * Rb * Rc) * Rd + (Rb * Rb + 2 * Rb * Rc + 2 * Rb * Rd) * Re) * Rf * Rf + (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rc + Rd + Re) * Rf * Rf + (Rb * Rb + 2 * Rb * Rc) * Rd + (Rb * Rb + 2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd) * Re + (2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd + 2 * (Rb + Rc + Rd) * Re) * Rf) * Rg * Rg + ((Rb * Rb + 2 * Rb * Rc + 2 * Rb * Rd) * Re * Re + 2 * (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb * Rb + 2 * Rb * Rc) * Rd) * Re) * Rf + ((Rb * Rb + 2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd) * Re * Re + (2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd + 2 * (Rb + Rc + Rd) * Re + Re * Re) * Rf * Rf + 2 * (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb * Rb + 2 * Rb * Rc) * Rd) * Re + 2 * (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb + Rc + Rd) * Re * Re + (Rb * Rb + 2 * Rb * Rc) * Rd + (Rb * Rb + 3 * Rb * Rc + Rc * Rc + (3 * Rb + 2 * Rc) * Rd + Rd * Rd) * Re) * Rf) * Rg), ((Rb * Rb * Rc + Rb * Rb * Rd) * Re * Rf + (Rb * Rb * Rc + Rb * Rb * Rd + Rb * Rb * Re) * Rf * Rf - (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb * Rb + 2 * Rb * Rc) * Rd + (Rb * Rc + Rb * Rd) * Rf) * Rg * Rg + ((Rb * Rc + Rb * Rd + Rb * Re) * Rf * Rf - (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb * Rb + 2 * Rb * Rc) * Rd) * Re - (Rb * Rc * Rc + 2 * Rb * Rc * Rd + Rb * Rd * Rd - Rb * Rb * Re) * Rf) * Rg) / ((Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb * Rb + 2 * Rb * Rc) * Rd) * Re * Re + (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + Rb * Re * Re + (Rb * Rb + 2 * Rb * Rc) * Rd + (Rb * Rb + 2 * Rb * Rc + 2 * Rb * Rd) * Re) * Rf * Rf + (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rc + Rd + Re) * Rf * Rf + (Rb * Rb + 2 * Rb * Rc) * Rd + (Rb * Rb + 2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd) * Re + (2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd + 2 * (Rb + Rc + Rd) * Re) * Rf) * Rg * Rg + ((Rb * Rb + 2 * Rb * Rc + 2 * Rb * Rd) * Re * Re + 2 * (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb * Rb + 2 * Rb * Rc) * Rd) * Re) * Rf + ((Rb * Rb + 2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd) * Re * Re + (2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd + 2 * (Rb + Rc + Rd) * Re + Re * Re) * Rf * Rf + 2 * (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb * Rb + 2 * Rb * Rc) * Rd) * Re + 2 * (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb + Rc + Rd) * Re * Re + (Rb * Rb + 2 * Rb * Rc) * Rd + (Rb * Rb + 3 * Rb * Rc + Rc * Rc + (3 * Rb + 2 * Rc) * Rd + Rd * Rd) * Re) * Rf) * Rg), -((Rb * Rb * Rc + Rb * Rb * Rd) * Re * Re + (2 * Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + 2 * (Rb * Rb + Rb * Rc) * Rd + 2 * (Rb * Rb + Rb * Rc + Rb * Rd) * Re + 2 * (Rb * Rc + Rb * Rd + Rb * Re) * Rf) * Rg * Rg + (Rb * Rb * Re * Re + (Rb * Rb * Rc + Rb * Rb * Rd) * Re) * Rf + (2 * (Rb * Rb + Rb * Rc + Rb * Rd) * Re * Re + (3 * Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (3 * Rb * Rb + 2 * Rb * Rc) * Rd) * Re + (2 * Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + 2 * Rb * Re * Re + 2 * (Rb * Rb + Rb * Rc) * Rd + (2 * Rb * Rb + 3 * Rb * Rc + 3 * Rb * Rd) * Re) * Rf) * Rg) / ((Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb * Rb + 2 * Rb * Rc) * Rd) * Re * Re + (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + Rb * Re * Re + (Rb * Rb + 2 * Rb * Rc) * Rd + (Rb * Rb + 2 * Rb * Rc + 2 * Rb * Rd) * Re) * Rf * Rf + (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rc + Rd + Re) * Rf * Rf + (Rb * Rb + 2 * Rb * Rc) * Rd + (Rb * Rb + 2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd) * Re + (2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd + 2 * (Rb + Rc + Rd) * Re) * Rf) * Rg * Rg + ((Rb * Rb + 2 * Rb * Rc + 2 * Rb * Rd) * Re * Re + 2 * (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb * Rb + 2 * Rb * Rc) * Rd) * Re) * Rf + ((Rb * Rb + 2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd) * Re * Re + (2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd + 2 * (Rb + Rc + Rd) * Re + Re * Re) * Rf * Rf + 2 * (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb * Rb + 2 * Rb * Rc) * Rd) * Re + 2 * (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb + Rc + Rd) * Re * Re + (Rb * Rb + 2 * Rb * Rc) * Rd + (Rb * Rb + 3 * Rb * Rc + Rc * Rc + (3 * Rb + 2 * Rc) * Rd + Rd * Rd) * Re) * Rf) * Rg), -((Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb * Rb + 2 * Rb * Rc) * Rd) * Re * Re + (2 * Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + Rb * Re * Re + 2 * (Rb * Rb + Rb * Rc) * Rd + 2 * (Rb * Rb + Rb * Rc + Rb * Rd) * Re) * Rf * Rf + ((Rb * Rb + 2 * Rb * Rc + 2 * Rb * Rd) * Re * Re + (3 * Rb * Rb * Rc + 2 * Rb * Rc * Rc + 2 * Rb * Rd * Rd + (3 * Rb * Rb + 4 * Rb * Rc) * Rd) * Re) * Rf + (2 * (Rb * Rc + Rb * Rd + Rb * Re) * Rf * Rf + (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb * Rb + 2 * Rb * Rc) * Rd) * Re + (2 * Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + 2 * (Rb * Rb + Rb * Rc) * Rd + (2 * Rb * Rb + 3 * Rb * Rc + 3 * Rb * Rd) * Re) * Rf) * Rg) / ((Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb * Rb + 2 * Rb * Rc) * Rd) * Re * Re + (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + Rb * Re * Re + (Rb * Rb + 2 * Rb * Rc) * Rd + (Rb * Rb + 2 * Rb * Rc + 2 * Rb * Rd) * Re) * Rf * Rf + (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rc + Rd + Re) * Rf * Rf + (Rb * Rb + 2 * Rb * Rc) * Rd + (Rb * Rb + 2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd) * Re + (2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd + 2 * (Rb + Rc + Rd) * Re) * Rf) * Rg * Rg + ((Rb * Rb + 2 * Rb * Rc + 2 * Rb * Rd) * Re * Re + 2 * (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb * Rb + 2 * Rb * Rc) * Rd) * Re) * Rf + ((Rb * Rb + 2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd) * Re * Re + (2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd + 2 * (Rb + Rc + Rd) * Re + Re * Re) * Rf * Rf + 2 * (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb * Rb + 2 * Rb * Rc) * Rd) * Re + 2 * (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb + Rc + Rd) * Re * Re + (Rb * Rb + 2 * Rb * Rc) * Rd + (Rb * Rb + 3 * Rb * Rc + Rc * Rc + (3 * Rb + 2 * Rc) * Rd + Rd * Rd) * Re) * Rf) * Rg) },
                                { -(Rb * Rc * Re + Rb * Rc * Rf + (Rb * Rc + Rc * Rf) * Rg) / ((Rb * Rc + Rb * Rd) * Re + (Rb * Rc + Rb * Rd + Rb * Re) * Rf + (Rb * Rc + Rb * Rd + (Rb + Rc + Rd) * Re + (Rc + Rd + Re) * Rf) * Rg), ((Rb * Rc * Rc + Rb * Rc * Rd) * Re * Re + (Rb * Rc * Rc + Rb * Rc * Rd + Rb * Rc * Re) * Rf * Rf + (Rb * Rc * Rc + Rb * Rc * Rd + 2 * (Rb * Rc + Rc * Rc + Rc * Rd) * Re + (Rc * Rc + Rc * Rd + 2 * Rc * Re) * Rf) * Rg * Rg + (Rb * Rc * Re * Re + 2 * (Rb * Rc * Rc + Rb * Rc * Rd) * Re) * Rf + (2 * (Rb * Rc + Rc * Rc + Rc * Rd) * Re * Re + (Rc * Rc + Rc * Rd + Rc * Re) * Rf * Rf + 2 * (Rb * Rc * Rc + Rb * Rc * Rd) * Re + (2 * Rb * Rc * Rc + 2 * Rb * Rc * Rd + 2 * Rc * Re * Re + 3 * (Rb * Rc + Rc * Rc + Rc * Rd) * Re) * Rf) * Rg) / ((Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb * Rb + 2 * Rb * Rc) * Rd) * Re * Re + (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + Rb * Re * Re + (Rb * Rb + 2 * Rb * Rc) * Rd + (Rb * Rb + 2 * Rb * Rc + 2 * Rb * Rd) * Re) * Rf * Rf + (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rc + Rd + Re) * Rf * Rf + (Rb * Rb + 2 * Rb * Rc) * Rd + (Rb * Rb + 2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd) * Re + (2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd + 2 * (Rb + Rc + Rd) * Re) * Rf) * Rg * Rg + ((Rb * Rb + 2 * Rb * Rc + 2 * Rb * Rd) * Re * Re + 2 * (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb * Rb + 2 * Rb * Rc) * Rd) * Re) * Rf + ((Rb * Rb + 2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd) * Re * Re + (2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd + 2 * (Rb + Rc + Rd) * Re + Re * Re) * Rf * Rf + 2 * (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb * Rb + 2 * Rb * Rc) * Rd) * Re + 2 * (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb + Rc + Rd) * Re * Re + (Rb * Rb + 2 * Rb * Rc) * Rd + (Rb * Rb + 3 * Rb * Rc + Rc * Rc + (3 * Rb + 2 * Rc) * Rd + Rd * Rd) * Re) * Rf) * Rg), -((Rb * Rc * Rc - Rb * Rb * Rd - Rb * Rd * Rd) * Re * Re + (Rb * Rc * Rc - Rb * Rb * Rd - Rb * Rd * Rd - Rb * Re * Re - (Rb * Rb + 2 * Rb * Rd) * Re) * Rf * Rf + (Rb * Rc * Rc - Rb * Rb * Rd - Rb * Rd * Rd - (Rd + Re) * Rf * Rf - (Rb * Rb - Rc * Rc + 2 * Rb * Rd + Rd * Rd) * Re + (Rc * Rc - 2 * Rb * Rd - Rd * Rd - 2 * (Rb + Rd) * Re) * Rf) * Rg * Rg - ((Rb * Rb + 2 * Rb * Rd) * Re * Re - 2 * (Rb * Rc * Rc - Rb * Rb * Rd - Rb * Rd * Rd) * Re) * Rf - ((Rb * Rb - Rc * Rc + 2 * Rb * Rd + Rd * Rd) * Re * Re - (Rc * Rc - 2 * Rb * Rd - Rd * Rd - 2 * (Rb + Rd) * Re - Re * Re) * Rf * Rf - 2 * (Rb * Rc * Rc - Rb * Rb * Rd - Rb * Rd * Rd) * Re - 2 * (Rb * Rc * Rc - Rb * Rb * Rd - Rb * Rd * Rd - (Rb + Rd) * Re * Re - (Rb * Rb - Rc * Rc + 3 * Rb * Rd + Rd * Rd) * Re) * Rf) * Rg) / ((Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb * Rb + 2 * Rb * Rc) * Rd) * Re * Re + (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + Rb * Re * Re + (Rb * Rb + 2 * Rb * Rc) * Rd + (Rb * Rb + 2 * Rb * Rc + 2 * Rb * Rd) * Re) * Rf * Rf + (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rc + Rd + Re) * Rf * Rf + (Rb * Rb + 2 * Rb * Rc) * Rd + (Rb * Rb + 2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd) * Re + (2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd + 2 * (Rb + Rc + Rd) * Re) * Rf) * Rg * Rg + ((Rb * Rb + 2 * Rb * Rc + 2 * Rb * Rd) * Re * Re + 2 * (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb * Rb + 2 * Rb * Rc) * Rd) * Re) * Rf + ((Rb * Rb + 2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd) * Re * Re + (2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd + 2 * (Rb + Rc + Rd) * Re + Re * Re) * Rf * Rf + 2 * (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb * Rb + 2 * Rb * Rc) * Rd) * Re + 2 * (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb + Rc + Rd) * Re * Re + (Rb * Rb + 2 * Rb * Rc) * Rd + (Rb * Rb + 3 * Rb * Rc + Rc * Rc + (3 * Rb + 2 * Rc) * Rd + Rd * Rd) * Re) * Rf) * Rg), -((Rb * Rb * Rc + 2 * Rb * Rc * Rc + 2 * Rb * Rc * Rd) * Re * Re + (Rb * Rb * Rc + 2 * Rb * Rc * Rc + 2 * Rb * Rc * Rd + 2 * Rb * Rc * Re) * Rf * Rf + (Rb * Rb * Rc + 2 * Rb * Rc * Rc + 2 * Rb * Rc * Rd + Rc * Rf * Rf + 2 * (Rb * Rc + Rc * Rc + Rc * Rd) * Re + 2 * (Rb * Rc + Rc * Rc + Rc * Rd + Rc * Re) * Rf) * Rg * Rg + 2 * (Rb * Rc * Re * Re + (Rb * Rb * Rc + 2 * Rb * Rc * Rc + 2 * Rb * Rc * Rd) * Re) * Rf + 2 * ((Rb * Rc + Rc * Rc + Rc * Rd) * Re * Re + (Rb * Rc + Rc * Rc + Rc * Rd + Rc * Re) * Rf * Rf + (Rb * Rb * Rc + 2 * Rb * Rc * Rc + 2 * Rb * Rc * Rd) * Re + (Rb * Rb * Rc + 2 * Rb * Rc * Rc + 2 * Rb * Rc * Rd + Rc * Re * Re + (3 * Rb * Rc + 2 * Rc * Rc + 2 * Rc * Rd) * Re) * Rf) * Rg) / ((Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb * Rb + 2 * Rb * Rc) * Rd) * Re * Re + (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + Rb * Re * Re + (Rb * Rb + 2 * Rb * Rc) * Rd + (Rb * Rb + 2 * Rb * Rc + 2 * Rb * Rd) * Re) * Rf * Rf + (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rc + Rd + Re) * Rf * Rf + (Rb * Rb + 2 * Rb * Rc) * Rd + (Rb * Rb + 2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd) * Re + (2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd + 2 * (Rb + Rc + Rd) * Re) * Rf) * Rg * Rg + ((Rb * Rb + 2 * Rb * Rc + 2 * Rb * Rd) * Re * Re + 2 * (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb * Rb + 2 * Rb * Rc) * Rd) * Re) * Rf + ((Rb * Rb + 2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd) * Re * Re + (2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd + 2 * (Rb + Rc + Rd) * Re + Re * Re) * Rf * Rf + 2 * (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb * Rb + 2 * Rb * Rc) * Rd) * Re + 2 * (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb + Rc + Rd) * Re * Re + (Rb * Rb + 2 * Rb * Rc) * Rd + (Rb * Rb + 3 * Rb * Rc + Rc * Rc + (3 * Rb + 2 * Rc) * Rd + Rd * Rd) * Re) * Rf) * Rg), -((Rb * Rb * Rc + 2 * Rb * Rc * Rc + 2 * Rb * Rc * Rd) * Re * Rf + (Rb * Rb * Rc + 2 * Rb * Rc * Rc + 2 * Rb * Rc * Rd + 2 * Rb * Rc * Re) * Rf * Rf + (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rc * Rd + Rc * Rf * Rf + (2 * Rb * Rc + Rc * Rc + Rc * Rd) * Rf) * Rg * Rg + (2 * (Rb * Rc + Rc * Rc + Rc * Rd + Rc * Re) * Rf * Rf + (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rc * Rd) * Re + (2 * Rb * Rb * Rc + 3 * Rb * Rc * Rc + 3 * Rb * Rc * Rd + (3 * Rb * Rc + 2 * Rc * Rc + 2 * Rc * Rd) * Re) * Rf) * Rg) / ((Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb * Rb + 2 * Rb * Rc) * Rd) * Re * Re + (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + Rb * Re * Re + (Rb * Rb + 2 * Rb * Rc) * Rd + (Rb * Rb + 2 * Rb * Rc + 2 * Rb * Rd) * Re) * Rf * Rf + (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rc + Rd + Re) * Rf * Rf + (Rb * Rb + 2 * Rb * Rc) * Rd + (Rb * Rb + 2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd) * Re + (2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd + 2 * (Rb + Rc + Rd) * Re) * Rf) * Rg * Rg + ((Rb * Rb + 2 * Rb * Rc + 2 * Rb * Rd) * Re * Re + 2 * (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb * Rb + 2 * Rb * Rc) * Rd) * Re) * Rf + ((Rb * Rb + 2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd) * Re * Re + (2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd + 2 * (Rb + Rc + Rd) * Re + Re * Re) * Rf * Rf + 2 * (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb * Rb + 2 * Rb * Rc) * Rd) * Re + 2 * (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb + Rc + Rd) * Re * Re + (Rb * Rb + 2 * Rb * Rc) * Rd + (Rb * Rb + 3 * Rb * Rc + Rc * Rc + (3 * Rb + 2 * Rc) * Rd + Rd * Rd) * Re) * Rf) * Rg), ((Rb * Rb * Rc + 2 * Rb * Rc * Rc + 2 * Rb * Rc * Rd) * Re * Re + (Rb * Rc * Rc + Rb * Rc * Rd + 2 * (Rb * Rc + Rc * Rc + Rc * Rd) * Re + (Rc * Rc + Rc * Rd + 2 * Rc * Re) * Rf) * Rg * Rg + (2 * Rb * Rc * Re * Re + (Rb * Rb * Rc + 2 * Rb * Rc * Rc + 2 * Rb * Rc * Rd) * Re) * Rf + (2 * (Rb * Rc + Rc * Rc + Rc * Rd) * Re * Re + (Rb * Rb * Rc + 3 * Rb * Rc * Rc + 3 * Rb * Rc * Rd) * Re + (Rb * Rc * Rc + Rb * Rc * Rd + 2 * Rc * Re * Re + (3 * Rb * Rc + 2 * Rc * Rc + 2 * Rc * Rd) * Re) * Rf) * Rg) / ((Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb * Rb + 2 * Rb * Rc) * Rd) * Re * Re + (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + Rb * Re * Re + (Rb * Rb + 2 * Rb * Rc) * Rd + (Rb * Rb + 2 * Rb * Rc + 2 * Rb * Rd) * Re) * Rf * Rf + (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rc + Rd + Re) * Rf * Rf + (Rb * Rb + 2 * Rb * Rc) * Rd + (Rb * Rb + 2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd) * Re + (2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd + 2 * (Rb + Rc + Rd) * Re) * Rf) * Rg * Rg + ((Rb * Rb + 2 * Rb * Rc + 2 * Rb * Rd) * Re * Re + 2 * (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb * Rb + 2 * Rb * Rc) * Rd) * Re) * Rf + ((Rb * Rb + 2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd) * Re * Re + (2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd + 2 * (Rb + Rc + Rd) * Re + Re * Re) * Rf * Rf + 2 * (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb * Rb + 2 * Rb * Rc) * Rd) * Re + 2 * (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb + Rc + Rd) * Re * Re + (Rb * Rb + 2 * Rb * Rc) * Rd + (Rb * Rb + 3 * Rb * Rc + Rc * Rc + (3 * Rb + 2 * Rc) * Rd + Rd * Rd) * Re) * Rf) * Rg), -((Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rc * Rd) * Re * Re - (Rb * Rc * Rc + Rb * Rc * Rd + Rb * Rc * Re) * Rf * Rf + (Rb * Rb * Rc * Re + Rb * Rc * Re * Re) * Rf - ((Rc * Rc + Rc * Rd + Rc * Re) * Rf * Rf - (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rc * Rd) * Re + (Rb * Rc * Rc + Rb * Rc * Rd + (Rc * Rc + Rc * Rd) * Re) * Rf) * Rg) / ((Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb * Rb + 2 * Rb * Rc) * Rd) * Re * Re + (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + Rb * Re * Re + (Rb * Rb + 2 * Rb * Rc) * Rd + (Rb * Rb + 2 * Rb * Rc + 2 * Rb * Rd) * Re) * Rf * Rf + (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rc + Rd + Re) * Rf * Rf + (Rb * Rb + 2 * Rb * Rc) * Rd + (Rb * Rb + 2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd) * Re + (2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd + 2 * (Rb + Rc + Rd) * Re) * Rf) * Rg * Rg + ((Rb * Rb + 2 * Rb * Rc + 2 * Rb * Rd) * Re * Re + 2 * (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb * Rb + 2 * Rb * Rc) * Rd) * Re) * Rf + ((Rb * Rb + 2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd) * Re * Re + (2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd + 2 * (Rb + Rc + Rd) * Re + Re * Re) * Rf * Rf + 2 * (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb * Rb + 2 * Rb * Rc) * Rd) * Re + 2 * (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb + Rc + Rd) * Re * Re + (Rb * Rb + 2 * Rb * Rc) * Rd + (Rb * Rb + 3 * Rb * Rc + Rc * Rc + (3 * Rb + 2 * Rc) * Rd + Rd * Rd) * Re) * Rf) * Rg) },
                                { -(Rb * Rd * Re + Rb * Rd * Rf + (Rb * Rd + Rd * Rf) * Rg) / ((Rb * Rc + Rb * Rd) * Re + (Rb * Rc + Rb * Rd + Rb * Re) * Rf + (Rb * Rc + Rb * Rd + (Rb + Rc + Rd) * Re + (Rc + Rd + Re) * Rf) * Rg), ((Rb * Rc * Rd + Rb * Rd * Rd) * Re * Re + (Rb * Rc * Rd + Rb * Rd * Rd + Rb * Rd * Re) * Rf * Rf + (Rb * Rc * Rd + Rb * Rd * Rd + 2 * ((Rb + Rc) * Rd + Rd * Rd) * Re + (Rc * Rd + Rd * Rd + 2 * Rd * Re) * Rf) * Rg * Rg + (Rb * Rd * Re * Re + 2 * (Rb * Rc * Rd + Rb * Rd * Rd) * Re) * Rf + (2 * ((Rb + Rc) * Rd + Rd * Rd) * Re * Re + (Rc * Rd + Rd * Rd + Rd * Re) * Rf * Rf + 2 * (Rb * Rc * Rd + Rb * Rd * Rd) * Re + (2 * Rb * Rc * Rd + 2 * Rb * Rd * Rd + 2 * Rd * Re * Re + 3 * ((Rb + Rc) * Rd + Rd * Rd) * Re) * Rf) * Rg) / ((Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb * Rb + 2 * Rb * Rc) * Rd) * Re * Re + (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + Rb * Re * Re + (Rb * Rb + 2 * Rb * Rc) * Rd + (Rb * Rb + 2 * Rb * Rc + 2 * Rb * Rd) * Re) * Rf * Rf + (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rc + Rd + Re) * Rf * Rf + (Rb * Rb + 2 * Rb * Rc) * Rd + (Rb * Rb + 2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd) * Re + (2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd + 2 * (Rb + Rc + Rd) * Re) * Rf) * Rg * Rg + ((Rb * Rb + 2 * Rb * Rc + 2 * Rb * Rd) * Re * Re + 2 * (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb * Rb + 2 * Rb * Rc) * Rd) * Re) * Rf + ((Rb * Rb + 2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd) * Re * Re + (2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd + 2 * (Rb + Rc + Rd) * Re + Re * Re) * Rf * Rf + 2 * (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb * Rb + 2 * Rb * Rc) * Rd) * Re + 2 * (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb + Rc + Rd) * Re * Re + (Rb * Rb + 2 * Rb * Rc) * Rd + (Rb * Rb + 3 * Rb * Rc + Rc * Rc + (3 * Rb + 2 * Rc) * Rd + Rd * Rd) * Re) * Rf) * Rg), -((2 * Rb * Rd * Rd + (Rb * Rb + 2 * Rb * Rc) * Rd) * Re * Re + (2 * Rb * Rd * Rd + 2 * Rb * Rd * Re + (Rb * Rb + 2 * Rb * Rc) * Rd) * Rf * Rf + (2 * Rb * Rd * Rd + Rd * Rf * Rf + (Rb * Rb + 2 * Rb * Rc) * Rd + 2 * ((Rb + Rc) * Rd + Rd * Rd) * Re + 2 * ((Rb + Rc) * Rd + Rd * Rd + Rd * Re) * Rf) * Rg * Rg + 2 * (Rb * Rd * Re * Re + (2 * Rb * Rd * Rd + (Rb * Rb + 2 * Rb * Rc) * Rd) * Re) * Rf + 2 * (((Rb + Rc) * Rd + Rd * Rd) * Re * Re + ((Rb + Rc) * Rd + Rd * Rd + Rd * Re) * Rf * Rf + (2 * Rb * Rd * Rd + (Rb * Rb + 2 * Rb * Rc) * Rd) * Re + (2 * Rb * Rd * Rd + Rd * Re * Re + (Rb * Rb + 2 * Rb * Rc) * Rd + ((3 * Rb + 2 * Rc) * Rd + 2 * Rd * Rd) * Re) * Rf) * Rg) / ((Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb * Rb + 2 * Rb * Rc) * Rd) * Re * Re + (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + Rb * Re * Re + (Rb * Rb + 2 * Rb * Rc) * Rd + (Rb * Rb + 2 * Rb * Rc + 2 * Rb * Rd) * Re) * Rf * Rf + (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rc + Rd + Re) * Rf * Rf + (Rb * Rb + 2 * Rb * Rc) * Rd + (Rb * Rb + 2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd) * Re + (2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd + 2 * (Rb + Rc + Rd) * Re) * Rf) * Rg * Rg + ((Rb * Rb + 2 * Rb * Rc + 2 * Rb * Rd) * Re * Re + 2 * (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb * Rb + 2 * Rb * Rc) * Rd) * Re) * Rf + ((Rb * Rb + 2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd) * Re * Re + (2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd + 2 * (Rb + Rc + Rd) * Re + Re * Re) * Rf * Rf + 2 * (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb * Rb + 2 * Rb * Rc) * Rd) * Re + 2 * (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb + Rc + Rd) * Re * Re + (Rb * Rb + 2 * Rb * Rc) * Rd + (Rb * Rb + 3 * Rb * Rc + Rc * Rc + (3 * Rb + 2 * Rc) * Rd + Rd * Rd) * Re) * Rf) * Rg), ((Rb * Rb * Rc + Rb * Rc * Rc - Rb * Rd * Rd) * Re * Re + (Rb * Rb * Rc + Rb * Rc * Rc - Rb * Rd * Rd + Rb * Re * Re + (Rb * Rb + 2 * Rb * Rc) * Re) * Rf * Rf + (Rb * Rb * Rc + Rb * Rc * Rc - Rb * Rd * Rd + (Rc + Re) * Rf * Rf + (Rb * Rb + 2 * Rb * Rc + Rc * Rc - Rd * Rd) * Re + (2 * Rb * Rc + Rc * Rc - Rd * Rd + 2 * (Rb + Rc) * Re) * Rf) * Rg * Rg + ((Rb * Rb + 2 * Rb * Rc) * Re * Re + 2 * (Rb * Rb * Rc + Rb * Rc * Rc - Rb * Rd * Rd) * Re) * Rf + ((Rb * Rb + 2 * Rb * Rc + Rc * Rc - Rd * Rd) * Re * Re + (2 * Rb * Rc + Rc * Rc - Rd * Rd + 2 * (Rb + Rc) * Re + Re * Re) * Rf * Rf + 2 * (Rb * Rb * Rc + Rb * Rc * Rc - Rb * Rd * Rd) * Re + 2 * (Rb * Rb * Rc + Rb * Rc * Rc - Rb * Rd * Rd + (Rb + Rc) * Re * Re + (Rb * Rb + 3 * Rb * Rc + Rc * Rc - Rd * Rd) * Re) * Rf) * Rg) / ((Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb * Rb + 2 * Rb * Rc) * Rd) * Re * Re + (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + Rb * Re * Re + (Rb * Rb + 2 * Rb * Rc) * Rd + (Rb * Rb + 2 * Rb * Rc + 2 * Rb * Rd) * Re) * Rf * Rf + (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rc + Rd + Re) * Rf * Rf + (Rb * Rb + 2 * Rb * Rc) * Rd + (Rb * Rb + 2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd) * Re + (2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd + 2 * (Rb + Rc + Rd) * Re) * Rf) * Rg * Rg + ((Rb * Rb + 2 * Rb * Rc + 2 * Rb * Rd) * Re * Re + 2 * (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb * Rb + 2 * Rb * Rc) * Rd) * Re) * Rf + ((Rb * Rb + 2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd) * Re * Re + (2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd + 2 * (Rb + Rc + Rd) * Re + Re * Re) * Rf * Rf + 2 * (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb * Rb + 2 * Rb * Rc) * Rd) * Re + 2 * (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb + Rc + Rd) * Re * Re + (Rb * Rb + 2 * Rb * Rc) * Rd + (Rb * Rb + 3 * Rb * Rc + Rc * Rc + (3 * Rb + 2 * Rc) * Rd + Rd * Rd) * Re) * Rf) * Rg), -((2 * Rb * Rd * Rd + (Rb * Rb + 2 * Rb * Rc) * Rd) * Re * Rf + (2 * Rb * Rd * Rd + 2 * Rb * Rd * Re + (Rb * Rb + 2 * Rb * Rc) * Rd) * Rf * Rf + (Rb * Rd * Rd + Rd * Rf * Rf + (Rb * Rb + Rb * Rc) * Rd + ((2 * Rb + Rc) * Rd + Rd * Rd) * Rf) * Rg * Rg + (2 * ((Rb + Rc) * Rd + Rd * Rd + Rd * Re) * Rf * Rf + (Rb * Rd * Rd + (Rb * Rb + Rb * Rc) * Rd) * Re + (3 * Rb * Rd * Rd + (2 * Rb * Rb + 3 * Rb * Rc) * Rd + ((3 * Rb + 2 * Rc) * Rd + 2 * Rd * Rd) * Re) * Rf) * Rg) / ((Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb * Rb + 2 * Rb * Rc) * Rd) * Re * Re + (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + Rb * Re * Re + (Rb * Rb + 2 * Rb * Rc) * Rd + (Rb * Rb + 2 * Rb * Rc + 2 * Rb * Rd) * Re) * Rf * Rf + (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rc + Rd + Re) * Rf * Rf + (Rb * Rb + 2 * Rb * Rc) * Rd + (Rb * Rb + 2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd) * Re + (2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd + 2 * (Rb + Rc + Rd) * Re) * Rf) * Rg * Rg + ((Rb * Rb + 2 * Rb * Rc + 2 * Rb * Rd) * Re * Re + 2 * (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb * Rb + 2 * Rb * Rc) * Rd) * Re) * Rf + ((Rb * Rb + 2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd) * Re * Re + (2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd + 2 * (Rb + Rc + Rd) * Re + Re * Re) * Rf * Rf + 2 * (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb * Rb + 2 * Rb * Rc) * Rd) * Re + 2 * (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb + Rc + Rd) * Re * Re + (Rb * Rb + 2 * Rb * Rc) * Rd + (Rb * Rb + 3 * Rb * Rc + Rc * Rc + (3 * Rb + 2 * Rc) * Rd + Rd * Rd) * Re) * Rf) * Rg), ((2 * Rb * Rd * Rd + (Rb * Rb + 2 * Rb * Rc) * Rd) * Re * Re + (Rb * Rc * Rd + Rb * Rd * Rd + 2 * ((Rb + Rc) * Rd + Rd * Rd) * Re + (Rc * Rd + Rd * Rd + 2 * Rd * Re) * Rf) * Rg * Rg + (2 * Rb * Rd * Re * Re + (2 * Rb * Rd * Rd + (Rb * Rb + 2 * Rb * Rc) * Rd) * Re) * Rf + (2 * ((Rb + Rc) * Rd + Rd * Rd) * Re * Re + (3 * Rb * Rd * Rd + (Rb * Rb + 3 * Rb * Rc) * Rd) * Re + (Rb * Rc * Rd + Rb * Rd * Rd + 2 * Rd * Re * Re + ((3 * Rb + 2 * Rc) * Rd + 2 * Rd * Rd) * Re) * Rf) * Rg) / ((Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb * Rb + 2 * Rb * Rc) * Rd) * Re * Re + (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + Rb * Re * Re + (Rb * Rb + 2 * Rb * Rc) * Rd + (Rb * Rb + 2 * Rb * Rc + 2 * Rb * Rd) * Re) * Rf * Rf + (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rc + Rd + Re) * Rf * Rf + (Rb * Rb + 2 * Rb * Rc) * Rd + (Rb * Rb + 2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd) * Re + (2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd + 2 * (Rb + Rc + Rd) * Re) * Rf) * Rg * Rg + ((Rb * Rb + 2 * Rb * Rc + 2 * Rb * Rd) * Re * Re + 2 * (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb * Rb + 2 * Rb * Rc) * Rd) * Re) * Rf + ((Rb * Rb + 2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd) * Re * Re + (2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd + 2 * (Rb + Rc + Rd) * Re + Re * Re) * Rf * Rf + 2 * (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb * Rb + 2 * Rb * Rc) * Rd) * Re + 2 * (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb + Rc + Rd) * Re * Re + (Rb * Rb + 2 * Rb * Rc) * Rd + (Rb * Rb + 3 * Rb * Rc + Rc * Rc + (3 * Rb + 2 * Rc) * Rd + Rd * Rd) * Re) * Rf) * Rg), -((Rb * Rd * Rd + (Rb * Rb + Rb * Rc) * Rd) * Re * Re - (Rb * Rc * Rd + Rb * Rd * Rd + Rb * Rd * Re) * Rf * Rf + (Rb * Rb * Rd * Re + Rb * Rd * Re * Re) * Rf - ((Rc * Rd + Rd * Rd + Rd * Re) * Rf * Rf - (Rb * Rd * Rd + (Rb * Rb + Rb * Rc) * Rd) * Re + (Rb * Rc * Rd + Rb * Rd * Rd + (Rc * Rd + Rd * Rd) * Re) * Rf) * Rg) / ((Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb * Rb + 2 * Rb * Rc) * Rd) * Re * Re + (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + Rb * Re * Re + (Rb * Rb + 2 * Rb * Rc) * Rd + (Rb * Rb + 2 * Rb * Rc + 2 * Rb * Rd) * Re) * Rf * Rf + (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rc + Rd + Re) * Rf * Rf + (Rb * Rb + 2 * Rb * Rc) * Rd + (Rb * Rb + 2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd) * Re + (2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd + 2 * (Rb + Rc + Rd) * Re) * Rf) * Rg * Rg + ((Rb * Rb + 2 * Rb * Rc + 2 * Rb * Rd) * Re * Re + 2 * (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb * Rb + 2 * Rb * Rc) * Rd) * Re) * Rf + ((Rb * Rb + 2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd) * Re * Re + (2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd + 2 * (Rb + Rc + Rd) * Re + Re * Re) * Rf * Rf + 2 * (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb * Rb + 2 * Rb * Rc) * Rd) * Re + 2 * (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb + Rc + Rd) * Re * Re + (Rb * Rb + 2 * Rb * Rc) * Rd + (Rb * Rb + 3 * Rb * Rc + Rc * Rc + (3 * Rb + 2 * Rc) * Rd + Rd * Rd) * Re) * Rf) * Rg) },
                                { -(Rb * Re * Rf + ((Rb + Rc + Rd) * Re + Re * Rf) * Rg) / ((Rb * Rc + Rb * Rd) * Re + (Rb * Rc + Rb * Rd + Rb * Re) * Rf + (Rb * Rc + Rb * Rd + (Rb + Rc + Rd) * Re + (Rc + Rd + Re) * Rf) * Rg), ((Rb * Rc + Rb * Rd) * Re * Re * Rf + (Rb * Re * Re + (Rb * Rc + Rb * Rd) * Re) * Rf * Rf - ((Rc + Rd) * Re * Rf + (Rb * Rc + Rc * Rc + (Rb + 2 * Rc) * Rd + Rd * Rd) * Re) * Rg * Rg - ((Rb * Rc + Rc * Rc + (Rb + 2 * Rc) * Rd + Rd * Rd) * Re * Re - ((Rc + Rd) * Re + Re * Re) * Rf * Rf - (Rb * Re * Re - (Rc * Rc + 2 * Rc * Rd + Rd * Rd) * Re) * Rf) * Rg) / ((Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb * Rb + 2 * Rb * Rc) * Rd) * Re * Re + (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + Rb * Re * Re + (Rb * Rb + 2 * Rb * Rc) * Rd + (Rb * Rb + 2 * Rb * Rc + 2 * Rb * Rd) * Re) * Rf * Rf + (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rc + Rd + Re) * Rf * Rf + (Rb * Rb + 2 * Rb * Rc) * Rd + (Rb * Rb + 2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd) * Re + (2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd + 2 * (Rb + Rc + Rd) * Re) * Rf) * Rg * Rg + ((Rb * Rb + 2 * Rb * Rc + 2 * Rb * Rd) * Re * Re + 2 * (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb * Rb + 2 * Rb * Rc) * Rd) * Re) * Rf + ((Rb * Rb + 2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd) * Re * Re + (2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd + 2 * (Rb + Rc + Rd) * Re + Re * Re) * Rf * Rf + 2 * (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb * Rb + 2 * Rb * Rc) * Rd) * Re + 2 * (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb + Rc + Rd) * Re * Re + (Rb * Rb + 2 * Rb * Rc) * Rd + (Rb * Rb + 3 * Rb * Rc + Rc * Rc + (3 * Rb + 2 * Rc) * Rd + Rd * Rd) * Re) * Rf) * Rg), -((Rb * Rb + 2 * Rb * Rc + 2 * Rb * Rd) * Re * Re * Rf + (2 * Rb * Re * Re + (Rb * Rb + 2 * Rb * Rc + 2 * Rb * Rd) * Re) * Rf * Rf + ((2 * Rb + Rc + Rd) * Re * Rf + Re * Rf * Rf + (Rb * Rb + Rb * Rc + Rb * Rd) * Re) * Rg * Rg + ((Rb * Rb + Rb * Rc + Rb * Rd) * Re * Re + 2 * ((Rb + Rc + Rd) * Re + Re * Re) * Rf * Rf + ((3 * Rb + 2 * Rc + 2 * Rd) * Re * Re + (2 * Rb * Rb + 3 * Rb * Rc + 3 * Rb * Rd) * Re) * Rf) * Rg) / ((Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb * Rb + 2 * Rb * Rc) * Rd) * Re * Re + (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + Rb * Re * Re + (Rb * Rb + 2 * Rb * Rc) * Rd + (Rb * Rb + 2 * Rb * Rc + 2 * Rb * Rd) * Re) * Rf * Rf + (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rc + Rd + Re) * Rf * Rf + (Rb * Rb + 2 * Rb * Rc) * Rd + (Rb * Rb + 2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd) * Re + (2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd + 2 * (Rb + Rc + Rd) * Re) * Rf) * Rg * Rg + ((Rb * Rb + 2 * Rb * Rc + 2 * Rb * Rd) * Re * Re + 2 * (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb * Rb + 2 * Rb * Rc) * Rd) * Re) * Rf + ((Rb * Rb + 2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd) * Re * Re + (2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd + 2 * (Rb + Rc + Rd) * Re + Re * Re) * Rf * Rf + 2 * (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb * Rb + 2 * Rb * Rc) * Rd) * Re + 2 * (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb + Rc + Rd) * Re * Re + (Rb * Rb + 2 * Rb * Rc) * Rd + (Rb * Rb + 3 * Rb * Rc + Rc * Rc + (3 * Rb + 2 * Rc) * Rd + Rd * Rd) * Re) * Rf) * Rg), -((Rb * Rb + 2 * Rb * Rc + 2 * Rb * Rd) * Re * Re * Rf + (2 * Rb * Re * Re + (Rb * Rb + 2 * Rb * Rc + 2 * Rb * Rd) * Re) * Rf * Rf + ((2 * Rb + Rc + Rd) * Re * Rf + Re * Rf * Rf + (Rb * Rb + Rb * Rc + Rb * Rd) * Re) * Rg * Rg + ((Rb * Rb + Rb * Rc + Rb * Rd) * Re * Re + 2 * ((Rb + Rc + Rd) * Re + Re * Re) * Rf * Rf + ((3 * Rb + 2 * Rc + 2 * Rd) * Re * Re + (2 * Rb * Rb + 3 * Rb * Rc + 3 * Rb * Rd) * Re) * Rf) * Rg) / ((Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb * Rb + 2 * Rb * Rc) * Rd) * Re * Re + (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + Rb * Re * Re + (Rb * Rb + 2 * Rb * Rc) * Rd + (Rb * Rb + 2 * Rb * Rc + 2 * Rb * Rd) * Re) * Rf * Rf + (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rc + Rd + Re) * Rf * Rf + (Rb * Rb + 2 * Rb * Rc) * Rd + (Rb * Rb + 2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd) * Re + (2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd + 2 * (Rb + Rc + Rd) * Re) * Rf) * Rg * Rg + ((Rb * Rb + 2 * Rb * Rc + 2 * Rb * Rd) * Re * Re + 2 * (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb * Rb + 2 * Rb * Rc) * Rd) * Re) * Rf + ((Rb * Rb + 2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd) * Re * Re + (2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd + 2 * (Rb + Rc + Rd) * Re + Re * Re) * Rf * Rf + 2 * (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb * Rb + 2 * Rb * Rc) * Rd) * Re + 2 * (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb + Rc + Rd) * Re * Re + (Rb * Rb + 2 * Rb * Rc) * Rd + (Rb * Rb + 3 * Rb * Rc + Rc * Rc + (3 * Rb + 2 * Rc) * Rd + Rd * Rd) * Re) * Rf) * Rg), -((Rb * Rb + 2 * Rb * Rc + 2 * Rb * Rd) * Re * Re * Rf + (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb * Rb + 2 * Rb * Rc) * Rd) * Re * Re - (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd - Rb * Re * Re + (Rb * Rb + 2 * Rb * Rc) * Rd) * Rf * Rf - (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rc + Rd) * Rf * Rf + (Rb * Rb + 2 * Rb * Rc) * Rd + (2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd) * Rf) * Rg * Rg + ((Rb * Rb + 2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd) * Re * Re - (2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd - Re * Re) * Rf * Rf - 2 * (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd - (Rb + Rc + Rd) * Re * Re + (Rb * Rb + 2 * Rb * Rc) * Rd) * Rf) * Rg) / ((Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb * Rb + 2 * Rb * Rc) * Rd) * Re * Re + (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + Rb * Re * Re + (Rb * Rb + 2 * Rb * Rc) * Rd + (Rb * Rb + 2 * Rb * Rc + 2 * Rb * Rd) * Re) * Rf * Rf + (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rc + Rd + Re) * Rf * Rf + (Rb * Rb + 2 * Rb * Rc) * Rd + (Rb * Rb + 2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd) * Re + (2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd + 2 * (Rb + Rc + Rd) * Re) * Rf) * Rg * Rg + ((Rb * Rb + 2 * Rb * Rc + 2 * Rb * Rd) * Re * Re + 2 * (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb * Rb + 2 * Rb * Rc) * Rd) * Re) * Rf + ((Rb * Rb + 2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd) * Re * Re + (2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd + 2 * (Rb + Rc + Rd) * Re + Re * Re) * Rf * Rf + 2 * (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb * Rb + 2 * Rb * Rc) * Rd) * Re + 2 * (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb + Rc + Rd) * Re * Re + (Rb * Rb + 2 * Rb * Rc) * Rd + (Rb * Rb + 3 * Rb * Rc + Rc * Rc + (3 * Rb + 2 * Rc) * Rd + Rd * Rd) * Re) * Rf) * Rg), -(2 * (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb * Rb + 2 * Rb * Rc) * Rd) * Re * Re + ((Rc + Rd) * Re * Rf + (Rb * Rc + Rc * Rc + (Rb + 2 * Rc) * Rd + Rd * Rd) * Re) * Rg * Rg + ((Rb * Rb + 2 * Rb * Rc + 2 * Rb * Rd) * Re * Re + 2 * (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb * Rb + 2 * Rb * Rc) * Rd) * Re) * Rf + ((Rb * Rb + 3 * Rb * Rc + 2 * Rc * Rc + (3 * Rb + 4 * Rc) * Rd + 2 * Rd * Rd) * Re * Re + 2 * (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb * Rb + 2 * Rb * Rc) * Rd) * Re + ((Rb + 2 * Rc + 2 * Rd) * Re * Re + (3 * Rb * Rc + 2 * Rc * Rc + (3 * Rb + 4 * Rc) * Rd + 2 * Rd * Rd) * Re) * Rf) * Rg) / ((Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb * Rb + 2 * Rb * Rc) * Rd) * Re * Re + (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + Rb * Re * Re + (Rb * Rb + 2 * Rb * Rc) * Rd + (Rb * Rb + 2 * Rb * Rc + 2 * Rb * Rd) * Re) * Rf * Rf + (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rc + Rd + Re) * Rf * Rf + (Rb * Rb + 2 * Rb * Rc) * Rd + (Rb * Rb + 2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd) * Re + (2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd + 2 * (Rb + Rc + Rd) * Re) * Rf) * Rg * Rg + ((Rb * Rb + 2 * Rb * Rc + 2 * Rb * Rd) * Re * Re + 2 * (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb * Rb + 2 * Rb * Rc) * Rd) * Re) * Rf + ((Rb * Rb + 2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd) * Re * Re + (2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd + 2 * (Rb + Rc + Rd) * Re + Re * Re) * Rf * Rf + 2 * (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb * Rb + 2 * Rb * Rc) * Rd) * Re + 2 * (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb + Rc + Rd) * Re * Re + (Rb * Rb + 2 * Rb * Rc) * Rd + (Rb * Rb + 3 * Rb * Rc + Rc * Rc + (3 * Rb + 2 * Rc) * Rd + Rd * Rd) * Re) * Rf) * Rg), (2 * (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb * Rb + 2 * Rb * Rc) * Rd) * Re * Re + (Rb * Re * Re + (Rb * Rc + Rb * Rd) * Re) * Rf * Rf + ((Rb * Rb + 3 * Rb * Rc + 3 * Rb * Rd) * Re * Re + 2 * (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb * Rb + 2 * Rb * Rc) * Rd) * Re) * Rf + ((Rb * Rb + 2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd) * Re * Re + ((Rc + Rd) * Re + Re * Re) * Rf * Rf + 2 * (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb * Rb + 2 * Rb * Rc) * Rd) * Re + (2 * (Rb + Rc + Rd) * Re * Re + (3 * Rb * Rc + Rc * Rc + (3 * Rb + 2 * Rc) * Rd + Rd * Rd) * Re) * Rf) * Rg) / ((Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb * Rb + 2 * Rb * Rc) * Rd) * Re * Re + (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + Rb * Re * Re + (Rb * Rb + 2 * Rb * Rc) * Rd + (Rb * Rb + 2 * Rb * Rc + 2 * Rb * Rd) * Re) * Rf * Rf + (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rc + Rd + Re) * Rf * Rf + (Rb * Rb + 2 * Rb * Rc) * Rd + (Rb * Rb + 2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd) * Re + (2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd + 2 * (Rb + Rc + Rd) * Re) * Rf) * Rg * Rg + ((Rb * Rb + 2 * Rb * Rc + 2 * Rb * Rd) * Re * Re + 2 * (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb * Rb + 2 * Rb * Rc) * Rd) * Re) * Rf + ((Rb * Rb + 2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd) * Re * Re + (2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd + 2 * (Rb + Rc + Rd) * Re + Re * Re) * Rf * Rf + 2 * (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb * Rb + 2 * Rb * Rc) * Rd) * Re + 2 * (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb + Rc + Rd) * Re * Re + (Rb * Rb + 2 * Rb * Rc) * Rd + (Rb * Rb + 3 * Rb * Rc + Rc * Rc + (3 * Rb + 2 * Rc) * Rd + Rd * Rd) * Re) * Rf) * Rg) },
                                { (Rb * Re * Rf - (Rc + Rd) * Rf * Rg) / ((Rb * Rc + Rb * Rd) * Re + (Rb * Rc + Rb * Rd + Rb * Re) * Rf + (Rb * Rc + Rb * Rd + (Rb + Rc + Rd) * Re + (Rc + Rd + Re) * Rf) * Rg), -((Rb * Rc + Rb * Rd) * Re * Re * Rf + (Rb * Re * Re + (Rb * Rc + Rb * Rd) * Re) * Rf * Rf + (2 * (Rc + Rd + Re) * Rf * Rf + (2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd + 2 * (Rb + Rc + Rd) * Re) * Rf) * Rg * Rg + ((2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd + (2 * Rb + 3 * Rc + 3 * Rd) * Re + 2 * Re * Re) * Rf * Rf + (2 * (Rb + Rc + Rd) * Re * Re + (3 * Rb * Rc + Rc * Rc + (3 * Rb + 2 * Rc) * Rd + Rd * Rd) * Re) * Rf) * Rg) / ((Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb * Rb + 2 * Rb * Rc) * Rd) * Re * Re + (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + Rb * Re * Re + (Rb * Rb + 2 * Rb * Rc) * Rd + (Rb * Rb + 2 * Rb * Rc + 2 * Rb * Rd) * Re) * Rf * Rf + (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rc + Rd + Re) * Rf * Rf + (Rb * Rb + 2 * Rb * Rc) * Rd + (Rb * Rb + 2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd) * Re + (2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd + 2 * (Rb + Rc + Rd) * Re) * Rf) * Rg * Rg + ((Rb * Rb + 2 * Rb * Rc + 2 * Rb * Rd) * Re * Re + 2 * (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb * Rb + 2 * Rb * Rc) * Rd) * Re) * Rf + ((Rb * Rb + 2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd) * Re * Re + (2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd + 2 * (Rb + Rc + Rd) * Re + Re * Re) * Rf * Rf + 2 * (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb * Rb + 2 * Rb * Rc) * Rd) * Re + 2 * (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb + Rc + Rd) * Re * Re + (Rb * Rb + 2 * Rb * Rc) * Rd + (Rb * Rb + 3 * Rb * Rc + Rc * Rc + (3 * Rb + 2 * Rc) * Rd + Rd * Rd) * Re) * Rf) * Rg), ((Rb * Rb + 2 * Rb * Rc + 2 * Rb * Rd) * Re * Re * Rf + (2 * Rb * Re * Re + (Rb * Rb + 2 * Rb * Rc + 2 * Rb * Rd) * Re) * Rf * Rf + ((Rc + Rd + 2 * Re) * Rf * Rf + (Rb * Rc + Rb * Rd + 2 * (Rb + Rc + Rd) * Re) * Rf) * Rg * Rg + ((Rb * Rc + Rb * Rd + (3 * Rb + 2 * Rc + 2 * Rd) * Re + 2 * Re * Re) * Rf * Rf + (2 * (Rb + Rc + Rd) * Re * Re + (Rb * Rb + 3 * Rb * Rc + 3 * Rb * Rd) * Re) * Rf) * Rg) / ((Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb * Rb + 2 * Rb * Rc) * Rd) * Re * Re + (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + Rb * Re * Re + (Rb * Rb + 2 * Rb * Rc) * Rd + (Rb * Rb + 2 * Rb * Rc + 2 * Rb * Rd) * Re) * Rf * Rf + (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rc + Rd + Re) * Rf * Rf + (Rb * Rb + 2 * Rb * Rc) * Rd + (Rb * Rb + 2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd) * Re + (2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd + 2 * (Rb + Rc + Rd) * Re) * Rf) * Rg * Rg + ((Rb * Rb + 2 * Rb * Rc + 2 * Rb * Rd) * Re * Re + 2 * (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb * Rb + 2 * Rb * Rc) * Rd) * Re) * Rf + ((Rb * Rb + 2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd) * Re * Re + (2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd + 2 * (Rb + Rc + Rd) * Re + Re * Re) * Rf * Rf + 2 * (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb * Rb + 2 * Rb * Rc) * Rd) * Re + 2 * (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb + Rc + Rd) * Re * Re + (Rb * Rb + 2 * Rb * Rc) * Rd + (Rb * Rb + 3 * Rb * Rc + Rc * Rc + (3 * Rb + 2 * Rc) * Rd + Rd * Rd) * Re) * Rf) * Rg), ((Rb * Rb + 2 * Rb * Rc + 2 * Rb * Rd) * Re * Re * Rf + (2 * Rb * Re * Re + (Rb * Rb + 2 * Rb * Rc + 2 * Rb * Rd) * Re) * Rf * Rf + ((Rc + Rd + 2 * Re) * Rf * Rf + (Rb * Rc + Rb * Rd + 2 * (Rb + Rc + Rd) * Re) * Rf) * Rg * Rg + ((Rb * Rc + Rb * Rd + (3 * Rb + 2 * Rc + 2 * Rd) * Re + 2 * Re * Re) * Rf * Rf + (2 * (Rb + Rc + Rd) * Re * Re + (Rb * Rb + 3 * Rb * Rc + 3 * Rb * Rd) * Re) * Rf) * Rg) / ((Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb * Rb + 2 * Rb * Rc) * Rd) * Re * Re + (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + Rb * Re * Re + (Rb * Rb + 2 * Rb * Rc) * Rd + (Rb * Rb + 2 * Rb * Rc + 2 * Rb * Rd) * Re) * Rf * Rf + (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rc + Rd + Re) * Rf * Rf + (Rb * Rb + 2 * Rb * Rc) * Rd + (Rb * Rb + 2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd) * Re + (2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd + 2 * (Rb + Rc + Rd) * Re) * Rf) * Rg * Rg + ((Rb * Rb + 2 * Rb * Rc + 2 * Rb * Rd) * Re * Re + 2 * (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb * Rb + 2 * Rb * Rc) * Rd) * Re) * Rf + ((Rb * Rb + 2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd) * Re * Re + (2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd + 2 * (Rb + Rc + Rd) * Re + Re * Re) * Rf * Rf + 2 * (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb * Rb + 2 * Rb * Rc) * Rd) * Re + 2 * (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb + Rc + Rd) * Re * Re + (Rb * Rb + 2 * Rb * Rc) * Rd + (Rb * Rb + 3 * Rb * Rc + Rc * Rc + (3 * Rb + 2 * Rc) * Rd + Rd * Rd) * Re) * Rf) * Rg), -(2 * (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb * Rb + 2 * Rb * Rc) * Rd) * Re * Rf + (2 * Rb * Rb * Rc + 2 * Rb * Rc * Rc + 2 * Rb * Rd * Rd + 2 * (Rb * Rb + 2 * Rb * Rc) * Rd + (Rb * Rb + 2 * Rb * Rc + 2 * Rb * Rd) * Re) * Rf * Rf + ((Rc + Rd) * Rf * Rf + (Rb * Rc + Rc * Rc + (Rb + 2 * Rc) * Rd + Rd * Rd) * Rf) * Rg * Rg + ((3 * Rb * Rc + 2 * Rc * Rc + (3 * Rb + 4 * Rc) * Rd + 2 * Rd * Rd + (Rb + 2 * Rc + 2 * Rd) * Re) * Rf * Rf + (2 * Rb * Rb * Rc + 2 * Rb * Rc * Rc + 2 * Rb * Rd * Rd + 2 * (Rb * Rb + 2 * Rb * Rc) * Rd + (Rb * Rb + 3 * Rb * Rc + 2 * Rc * Rc + (3 * Rb + 4 * Rc) * Rd + 2 * Rd * Rd) * Re) * Rf) * Rg) / ((Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb * Rb + 2 * Rb * Rc) * Rd) * Re * Re + (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + Rb * Re * Re + (Rb * Rb + 2 * Rb * Rc) * Rd + (Rb * Rb + 2 * Rb * Rc + 2 * Rb * Rd) * Re) * Rf * Rf + (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rc + Rd + Re) * Rf * Rf + (Rb * Rb + 2 * Rb * Rc) * Rd + (Rb * Rb + 2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd) * Re + (2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd + 2 * (Rb + Rc + Rd) * Re) * Rf) * Rg * Rg + ((Rb * Rb + 2 * Rb * Rc + 2 * Rb * Rd) * Re * Re + 2 * (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb * Rb + 2 * Rb * Rc) * Rd) * Re) * Rf + ((Rb * Rb + 2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd) * Re * Re + (2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd + 2 * (Rb + Rc + Rd) * Re + Re * Re) * Rf * Rf + 2 * (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb * Rb + 2 * Rb * Rc) * Rd) * Re + 2 * (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb + Rc + Rd) * Re * Re + (Rb * Rb + 2 * Rb * Rc) * Rd + (Rb * Rb + 3 * Rb * Rc + Rc * Rc + (3 * Rb + 2 * Rc) * Rd + Rd * Rd) * Re) * Rf) * Rg), ((Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb * Rb + 2 * Rb * Rc) * Rd) * Re * Re - (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + Rb * Re * Re + (Rb * Rb + 2 * Rb * Rc) * Rd + (Rb * Rb + 2 * Rb * Rc + 2 * Rb * Rd) * Re) * Rf * Rf + (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd - (Rc + Rd + Re) * Rf * Rf + (Rb * Rb + 2 * Rb * Rc) * Rd + (Rb * Rb + 2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd) * Re) * Rg * Rg + ((Rb * Rb + 2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd) * Re * Re - (2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd + 2 * (Rb + Rc + Rd) * Re + Re * Re) * Rf * Rf + 2 * (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb * Rb + 2 * Rb * Rc) * Rd) * Re) * Rg) / ((Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb * Rb + 2 * Rb * Rc) * Rd) * Re * Re + (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + Rb * Re * Re + (Rb * Rb + 2 * Rb * Rc) * Rd + (Rb * Rb + 2 * Rb * Rc + 2 * Rb * Rd) * Re) * Rf * Rf + (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rc + Rd + Re) * Rf * Rf + (Rb * Rb + 2 * Rb * Rc) * Rd + (Rb * Rb + 2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd) * Re + (2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd + 2 * (Rb + Rc + Rd) * Re) * Rf) * Rg * Rg + ((Rb * Rb + 2 * Rb * Rc + 2 * Rb * Rd) * Re * Re + 2 * (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb * Rb + 2 * Rb * Rc) * Rd) * Re) * Rf + ((Rb * Rb + 2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd) * Re * Re + (2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd + 2 * (Rb + Rc + Rd) * Re + Re * Re) * Rf * Rf + 2 * (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb * Rb + 2 * Rb * Rc) * Rd) * Re + 2 * (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb + Rc + Rd) * Re * Re + (Rb * Rb + 2 * Rb * Rc) * Rd + (Rb * Rb + 3 * Rb * Rc + Rc * Rc + (3 * Rb + 2 * Rc) * Rd + Rd * Rd) * Re) * Rf) * Rg), ((2 * Rb * Rb * Rc + 2 * Rb * Rc * Rc + 2 * Rb * Rd * Rd + Rb * Re * Re + 2 * (Rb * Rb + 2 * Rb * Rc) * Rd + (2 * Rb * Rb + 3 * Rb * Rc + 3 * Rb * Rd) * Re) * Rf * Rf + ((Rb * Rb + Rb * Rc + Rb * Rd) * Re * Re + 2 * (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb * Rb + 2 * Rb * Rc) * Rd) * Re) * Rf + ((2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd + (2 * Rb + Rc + Rd) * Re) * Rf * Rf + (2 * Rb * Rb * Rc + 2 * Rb * Rc * Rc + 2 * Rb * Rd * Rd + 2 * (Rb * Rb + 2 * Rb * Rc) * Rd + (2 * Rb * Rb + 3 * Rb * Rc + Rc * Rc + (3 * Rb + 2 * Rc) * Rd + Rd * Rd) * Re) * Rf) * Rg) / ((Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb * Rb + 2 * Rb * Rc) * Rd) * Re * Re + (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + Rb * Re * Re + (Rb * Rb + 2 * Rb * Rc) * Rd + (Rb * Rb + 2 * Rb * Rc + 2 * Rb * Rd) * Re) * Rf * Rf + (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rc + Rd + Re) * Rf * Rf + (Rb * Rb + 2 * Rb * Rc) * Rd + (Rb * Rb + 2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd) * Re + (2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd + 2 * (Rb + Rc + Rd) * Re) * Rf) * Rg * Rg + ((Rb * Rb + 2 * Rb * Rc + 2 * Rb * Rd) * Re * Re + 2 * (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb * Rb + 2 * Rb * Rc) * Rd) * Re) * Rf + ((Rb * Rb + 2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd) * Re * Re + (2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd + 2 * (Rb + Rc + Rd) * Re + Re * Re) * Rf * Rf + 2 * (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb * Rb + 2 * Rb * Rc) * Rd) * Re + 2 * (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb + Rc + Rd) * Re * Re + (Rb * Rb + 2 * Rb * Rc) * Rd + (Rb * Rb + 3 * Rb * Rc + Rc * Rc + (3 * Rb + 2 * Rc) * Rd + Rd * Rd) * Re) * Rf) * Rg) },
                                { -((Rb + Rc + Rd) * Re + (Rc + Rd + Re) * Rf) * Rg / ((Rb * Rc + Rb * Rd) * Re + (Rb * Rc + Rb * Rd + Rb * Re) * Rf + (Rb * Rc + Rb * Rd + (Rb + Rc + Rd) * Re + (Rc + Rd + Re) * Rf) * Rg), -((2 * (Rc + Rd + Re) * Rf * Rf + (Rb * Rc + Rc * Rc + (Rb + 2 * Rc) * Rd + Rd * Rd) * Re + (2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd + (2 * Rb + 3 * Rc + 3 * Rd) * Re) * Rf) * Rg * Rg + ((Rb * Rc + Rc * Rc + (Rb + 2 * Rc) * Rd + Rd * Rd) * Re * Re + (2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd + 2 * (Rb + Rc + Rd) * Re + Re * Re) * Rf * Rf + ((Rb + 2 * Rc + 2 * Rd) * Re * Re + (3 * Rb * Rc + 2 * Rc * Rc + (3 * Rb + 4 * Rc) * Rd + 2 * Rd * Rd) * Re) * Rf) * Rg) / ((Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb * Rb + 2 * Rb * Rc) * Rd) * Re * Re + (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + Rb * Re * Re + (Rb * Rb + 2 * Rb * Rc) * Rd + (Rb * Rb + 2 * Rb * Rc + 2 * Rb * Rd) * Re) * Rf * Rf + (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rc + Rd + Re) * Rf * Rf + (Rb * Rb + 2 * Rb * Rc) * Rd + (Rb * Rb + 2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd) * Re + (2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd + 2 * (Rb + Rc + Rd) * Re) * Rf) * Rg * Rg + ((Rb * Rb + 2 * Rb * Rc + 2 * Rb * Rd) * Re * Re + 2 * (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb * Rb + 2 * Rb * Rc) * Rd) * Re) * Rf + ((Rb * Rb + 2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd) * Re * Re + (2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd + 2 * (Rb + Rc + Rd) * Re + Re * Re) * Rf * Rf + 2 * (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb * Rb + 2 * Rb * Rc) * Rd) * Re + 2 * (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb + Rc + Rd) * Re * Re + (Rb * Rb + 2 * Rb * Rc) * Rd + (Rb * Rb + 3 * Rb * Rc + Rc * Rc + (3 * Rb + 2 * Rc) * Rd + Rd * Rd) * Re) * Rf) * Rg), (((Rc + Rd + Re) * Rf * Rf - (Rb * Rb + Rb * Rc + Rb * Rd) * Re + (Rb * Rc + Rb * Rd + (Rc + Rd) * Re) * Rf) * Rg * Rg - ((Rb * Rb + Rb * Rc + Rb * Rd) * Re * Re - (Rb * Rc + Rb * Rd + Rb * Re) * Rf * Rf + (Rb * Rb * Re + Rb * Re * Re) * Rf) * Rg) / ((Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb * Rb + 2 * Rb * Rc) * Rd) * Re * Re + (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + Rb * Re * Re + (Rb * Rb + 2 * Rb * Rc) * Rd + (Rb * Rb + 2 * Rb * Rc + 2 * Rb * Rd) * Re) * Rf * Rf + (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rc + Rd + Re) * Rf * Rf + (Rb * Rb + 2 * Rb * Rc) * Rd + (Rb * Rb + 2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd) * Re + (2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd + 2 * (Rb + Rc + Rd) * Re) * Rf) * Rg * Rg + ((Rb * Rb + 2 * Rb * Rc + 2 * Rb * Rd) * Re * Re + 2 * (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb * Rb + 2 * Rb * Rc) * Rd) * Re) * Rf + ((Rb * Rb + 2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd) * Re * Re + (2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd + 2 * (Rb + Rc + Rd) * Re + Re * Re) * Rf * Rf + 2 * (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb * Rb + 2 * Rb * Rc) * Rd) * Re + 2 * (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb + Rc + Rd) * Re * Re + (Rb * Rb + 2 * Rb * Rc) * Rd + (Rb * Rb + 3 * Rb * Rc + Rc * Rc + (3 * Rb + 2 * Rc) * Rd + Rd * Rd) * Re) * Rf) * Rg), (((Rc + Rd + Re) * Rf * Rf - (Rb * Rb + Rb * Rc + Rb * Rd) * Re + (Rb * Rc + Rb * Rd + (Rc + Rd) * Re) * Rf) * Rg * Rg - ((Rb * Rb + Rb * Rc + Rb * Rd) * Re * Re - (Rb * Rc + Rb * Rd + Rb * Re) * Rf * Rf + (Rb * Rb * Re + Rb * Re * Re) * Rf) * Rg) / ((Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb * Rb + 2 * Rb * Rc) * Rd) * Re * Re + (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + Rb * Re * Re + (Rb * Rb + 2 * Rb * Rc) * Rd + (Rb * Rb + 2 * Rb * Rc + 2 * Rb * Rd) * Re) * Rf * Rf + (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rc + Rd + Re) * Rf * Rf + (Rb * Rb + 2 * Rb * Rc) * Rd + (Rb * Rb + 2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd) * Re + (2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd + 2 * (Rb + Rc + Rd) * Re) * Rf) * Rg * Rg + ((Rb * Rb + 2 * Rb * Rc + 2 * Rb * Rd) * Re * Re + 2 * (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb * Rb + 2 * Rb * Rc) * Rd) * Re) * Rf + ((Rb * Rb + 2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd) * Re * Re + (2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd + 2 * (Rb + Rc + Rd) * Re + Re * Re) * Rf * Rf + 2 * (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb * Rb + 2 * Rb * Rc) * Rd) * Re + 2 * (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb + Rc + Rd) * Re * Re + (Rb * Rb + 2 * Rb * Rc) * Rd + (Rb * Rb + 3 * Rb * Rc + Rc * Rc + (3 * Rb + 2 * Rc) * Rd + Rd * Rd) * Re) * Rf) * Rg), ((2 * Rb * Rb * Rc + 2 * Rb * Rc * Rc + 2 * Rb * Rd * Rd + (Rc + Rd + Re) * Rf * Rf + 2 * (Rb * Rb + 2 * Rb * Rc) * Rd + (Rb * Rb + 2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd) * Re + (3 * Rb * Rc + Rc * Rc + (3 * Rb + 2 * Rc) * Rd + Rd * Rd + 2 * (Rb + Rc + Rd) * Re) * Rf) * Rg * Rg + ((Rb * Rc + Rb * Rd + Rb * Re) * Rf * Rf + 2 * (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb * Rb + 2 * Rb * Rc) * Rd) * Re + (2 * Rb * Rb * Rc + 2 * Rb * Rc * Rc + 2 * Rb * Rd * Rd + 2 * (Rb * Rb + 2 * Rb * Rc) * Rd + (Rb * Rb + 3 * Rb * Rc + 3 * Rb * Rd) * Re) * Rf) * Rg) / ((Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb * Rb + 2 * Rb * Rc) * Rd) * Re * Re + (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + Rb * Re * Re + (Rb * Rb + 2 * Rb * Rc) * Rd + (Rb * Rb + 2 * Rb * Rc + 2 * Rb * Rd) * Re) * Rf * Rf + (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rc + Rd + Re) * Rf * Rf + (Rb * Rb + 2 * Rb * Rc) * Rd + (Rb * Rb + 2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd) * Re + (2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd + 2 * (Rb + Rc + Rd) * Re) * Rf) * Rg * Rg + ((Rb * Rb + 2 * Rb * Rc + 2 * Rb * Rd) * Re * Re + 2 * (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb * Rb + 2 * Rb * Rc) * Rd) * Re) * Rf + ((Rb * Rb + 2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd) * Re * Re + (2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd + 2 * (Rb + Rc + Rd) * Re + Re * Re) * Rf * Rf + 2 * (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb * Rb + 2 * Rb * Rc) * Rd) * Re + 2 * (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb + Rc + Rd) * Re * Re + (Rb * Rb + 2 * Rb * Rc) * Rd + (Rb * Rb + 3 * Rb * Rc + Rc * Rc + (3 * Rb + 2 * Rc) * Rd + Rd * Rd) * Re) * Rf) * Rg), ((2 * Rb * Rb * Rc + 2 * Rb * Rc * Rc + 2 * Rb * Rd * Rd + 2 * (Rb * Rb + 2 * Rb * Rc) * Rd + (2 * Rb * Rb + 3 * Rb * Rc + Rc * Rc + (3 * Rb + 2 * Rc) * Rd + Rd * Rd) * Re + (2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd + (2 * Rb + Rc + Rd) * Re) * Rf) * Rg * Rg + ((Rb * Rb + Rb * Rc + Rb * Rd) * Re * Re + 2 * (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb * Rb + 2 * Rb * Rc) * Rd) * Re + (2 * Rb * Rb * Rc + 2 * Rb * Rc * Rc + 2 * Rb * Rd * Rd + Rb * Re * Re + 2 * (Rb * Rb + 2 * Rb * Rc) * Rd + (2 * Rb * Rb + 3 * Rb * Rc + 3 * Rb * Rd) * Re) * Rf) * Rg) / ((Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb * Rb + 2 * Rb * Rc) * Rd) * Re * Re + (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + Rb * Re * Re + (Rb * Rb + 2 * Rb * Rc) * Rd + (Rb * Rb + 2 * Rb * Rc + 2 * Rb * Rd) * Re) * Rf * Rf + (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rc + Rd + Re) * Rf * Rf + (Rb * Rb + 2 * Rb * Rc) * Rd + (Rb * Rb + 2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd) * Re + (2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd + 2 * (Rb + Rc + Rd) * Re) * Rf) * Rg * Rg + ((Rb * Rb + 2 * Rb * Rc + 2 * Rb * Rd) * Re * Re + 2 * (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb * Rb + 2 * Rb * Rc) * Rd) * Re) * Rf + ((Rb * Rb + 2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd) * Re * Re + (2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd + 2 * (Rb + Rc + Rd) * Re + Re * Re) * Rf * Rf + 2 * (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb * Rb + 2 * Rb * Rc) * Rd) * Re + 2 * (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb + Rc + Rd) * Re * Re + (Rb * Rb + 2 * Rb * Rc) * Rd + (Rb * Rb + 3 * Rb * Rc + Rc * Rc + (3 * Rb + 2 * Rc) * Rd + Rd * Rd) * Re) * Rf) * Rg), ((Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb * Rb + 2 * Rb * Rc) * Rd) * Re * Re + (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + Rb * Re * Re + (Rb * Rb + 2 * Rb * Rc) * Rd + (Rb * Rb + 2 * Rb * Rc + 2 * Rb * Rd) * Re) * Rf * Rf - (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rc + Rd + Re) * Rf * Rf + (Rb * Rb + 2 * Rb * Rc) * Rd + (Rb * Rb + 2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd) * Re + (2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd + 2 * (Rb + Rc + Rd) * Re) * Rf) * Rg * Rg + ((Rb * Rb + 2 * Rb * Rc + 2 * Rb * Rd) * Re * Re + 2 * (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb * Rb + 2 * Rb * Rc) * Rd) * Re) * Rf) / ((Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb * Rb + 2 * Rb * Rc) * Rd) * Re * Re + (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + Rb * Re * Re + (Rb * Rb + 2 * Rb * Rc) * Rd + (Rb * Rb + 2 * Rb * Rc + 2 * Rb * Rd) * Re) * Rf * Rf + (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rc + Rd + Re) * Rf * Rf + (Rb * Rb + 2 * Rb * Rc) * Rd + (Rb * Rb + 2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd) * Re + (2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd + 2 * (Rb + Rc + Rd) * Re) * Rf) * Rg * Rg + ((Rb * Rb + 2 * Rb * Rc + 2 * Rb * Rd) * Re * Re + 2 * (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb * Rb + 2 * Rb * Rc) * Rd) * Re) * Rf + ((Rb * Rb + 2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd) * Re * Re + (2 * Rb * Rc + Rc * Rc + 2 * (Rb + Rc) * Rd + Rd * Rd + 2 * (Rb + Rc + Rd) * Re + Re * Re) * Rf * Rf + 2 * (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb * Rb + 2 * Rb * Rc) * Rd) * Re + 2 * (Rb * Rb * Rc + Rb * Rc * Rc + Rb * Rd * Rd + (Rb + Rc + Rd) * Re * Re + (Rb * Rb + 2 * Rb * Rc) * Rd + (Rb * Rb + 3 * Rb * Rc + Rc * Rc + (3 * Rb + 2 * Rc) * Rd + Rd * Rd) * Re) * Rf) * Rg) } });

            const auto Ra = ((Rb * Rc + Rb * Rd) * Re + (Rb * Rc + Rb * Rd + Rb * Re) * Rf + (Rb * Rc + Rb * Rd + (Rb + Rc + Rd) * Re + (Rc + Rd + Re) * Rf) * Rg) / ((Rb + Rc + Rd) * Re + (Rb + Rc + Rd + Re) * Rf + (Rb + Rc + Rd + Rf) * Rg);
            return Ra;
        }
    };

    wdft::RtypeAdaptor<float, 0, ImpedanceCalc, decltype (Sb), decltype (P_treble_cut_plus), decltype (Ptreble_cut), decltype (Pbass_boost), decltype (Rb), decltype (Rload)> R { Sb, P_treble_cut_plus, Ptreble_cut, Pbass_boost, Rb, Rload };

    // Port A
    wdft::CapacitorT<float> C_treble_boost { 0.0082e-6f }; // 8 kHz
    NonlinearInductorT<float> L_treble_boost { 47.0e-3f }; // 8 kHz
    // wdft::InductorT<float> L_treble_boost { 47.0e-3f }; // 8 kHz
    wdft::WDFSeriesT<float, decltype (C_treble_boost), decltype (L_treble_boost)> Streble_boost_1 { C_treble_boost, L_treble_boost };
    wdft::ResistorT<float> R_treble_boost_bw { 2.0e3f };
    wdft::WDFSeriesT<float, decltype (Streble_boost_1), decltype (R_treble_boost_bw)> Streble_boost { Streble_boost_1, R_treble_boost_bw };
    wdft::ResistorT<float> P_treble_boost_minus { 5.0e3f };
    wdft::WDFParallelT<float, decltype (Streble_boost), decltype (P_treble_boost_minus)> Ptreble_boost { Streble_boost, P_treble_boost_minus };
    wdft::ResistorT<float> P_treble_boost_plus { 5.0e3f };
    wdft::WDFSeriesT<float, decltype (Ptreble_boost), decltype (P_treble_boost_plus)> Svin { Ptreble_boost, P_treble_boost_plus };
    wdft::WDFSeriesT<float, decltype (Svin), decltype (R)> SR { Svin, R };
    wdft::ResistorT<float> Ra { 620.0f };
    wdft::WDFParallelT<float, decltype (Ra), decltype (SR)> Pvin { Ra, SR };
    wdft::IdealVoltageSourceT<float, decltype (Pvin)> Vin { Pvin };
};

static analog_eq::Params get_parameters (float treble_boost, float treble_boost_q, float treble_boost_freq, float treble_cut, float treble_cut_freq, float low_boost, float low_cut, float bass_freq)
{
    // see sim/pultec_bass_freq_curve_fit.py
    const auto P_low_cut = 1.0f + std::pow (low_cut, 1.443f) * 99.999e3f;
    const auto P_low_boost = 1.0f + std::pow (low_boost, 2.587f) * 9.999e3f;
    const auto bass_boost_cap_val = 1.0f / (2.0f * (float) M_PI * 1.13062281e+04f * (bass_freq - 1.30692349e+01f)) + 1.68909808e-07f;
    const auto bass_cut_cap_val = 1.0f / (2.0f * (float) M_PI * 2.27142549e+05f * (bass_freq - 1.24565293e+01f)) + 7.10814416e-09f;

    const auto treble_cut_skew = std::pow (treble_cut, 0.395f);
    const auto P_treble_cut_plus = 1.0e3f * (1.0f - treble_cut_skew);
    const auto P_treble_cut_minus = 1.0e3f * treble_cut_skew;
    const auto treble_cut_cap_val = 1.0f / (2.0f * (float) M_PI * 169.3f * treble_cut_freq);

    const auto treble_boost_skew = std::pow (treble_boost, 0.621f);
    const auto P_treble_boost_plus = 10.0e3f * (1.0f - treble_boost_skew);
    const auto P_treble_boost_minus = 10.0e3f * treble_boost_skew;
    const auto R_treble_boost_bw = 1.0f + (1.0f - treble_boost_q) * 2499.0f;

    // see sim/pultec_treble_boost_freq_curve_fit.py
    const auto A_r = std::sqrt (1.0e7f);
    const auto g_val = 9.75043069e-05f + treble_boost_freq * (-2.05889893e-08f + treble_boost_freq * (1.73050404e-12f + treble_boost_freq * -4.96665892e-17f));
    const auto treble_boost_cap_val = g_val / A_r;
    const auto treble_boost_ind_val = A_r * A_r * treble_boost_cap_val;

    return {
        .P_treble_boost_plus_value = P_treble_boost_plus,
        .P_treble_boost_minus_value = P_treble_boost_minus,
        .R_treble_boost_bw_value = R_treble_boost_bw,
        .C_treble_boost_value = treble_boost_cap_val,
        .L_treble_boost_params = {
            .value = treble_boost_ind_val,
        },
        .P_low_cut_value = P_low_cut,
        .C_low_cut_value = bass_cut_cap_val,
        .P_treble_cut_plus_value = P_treble_cut_plus,
        .P_treble_cut_minus_value = P_treble_cut_minus,
        .C_treble_cut_value = treble_cut_cap_val,
        .P_low_boost_value = P_low_boost,
        .C_low_boost_value = bass_boost_cap_val,
    };
}

int main()
{
    std::cout << "Analog EQ test\n";

    static constexpr float fs = 48000.0f;

    const auto treble_boost = 0.5f;
    const auto treble_boost_q = 0.5f;
    const auto treble_boost_freq = 5000.0f;
    const auto treble_cut = 0.25f;
    const auto treble_cut_freq = 10'000.0f;
    const auto low_boost = 0.75f;
    const auto low_cut = 0.3f;
    const auto bass_freq = 100.0f;

    Reference_WDF ref {};
    ref.setParameters (treble_boost, treble_boost_q, treble_boost_freq, treble_cut, treble_cut_freq, low_boost, low_cut, bass_freq);
    ref.prepare (fs);

    analog_eq::Impedances impedances {};
    const auto params = get_parameters (treble_boost, treble_boost_q, treble_boost_freq, treble_cut, treble_cut_freq, low_boost, low_cut, bass_freq);
    calc_impedances (impedances, fs, params);
    analog_eq::State state {};

    static constexpr int N = 100;
    std::array<float, N> ref_output {};
    float max_error = 0.0f;
    for (int i = 0; i < N; ++i)
    {
        const auto test_output = process (state, impedances, 1.0f);
        ref_output[i] = ref.process (1.0f);
        const auto error = std::abs (test_output - ref_output[i]);
        max_error = std::max (error, max_error);
    }
    std::cout << "Max Error: " << max_error << '\n';

    if (max_error > 1.0e-4f)
    {
        std::cout << "Error is too large... failing test!\n";
        return 1;
    }

    std::ofstream ofp { "data.bin", std::ios::out | std::ios::binary };
    ofp.write(reinterpret_cast<const char*>(ref_output.data()), N * sizeof (float));
    ofp.close();

#if RUN_BENCH
    static constexpr int M = 10'000'000;
    static constexpr int n_iter = 10;

    auto* data_in = (float*) malloc (M * sizeof (float));
    auto* data_out = (float*) malloc (M * sizeof (float));

    std::random_device rd {};
    std::default_random_engine gen { rd() };
    std::uniform_real_distribution<float> dist { -1.0f, 1.0f };
    event_collector collector {};

    double ref_time, test_time;
    double ref_cycles, test_cycles;
    {
        event_aggregate aggregate {};
        float save_out = 0.0f;
        for (int iter = 0; iter < n_iter; ++iter)
        {
            for (int n = 0; n < M; ++n)
                data_in[n] = dist (gen);

            collector.start();
            for (int n = 0; n < M; ++n)
                data_out[n] = ref.process (data_in[n]);

            aggregate << collector.end();
            save_out += data_out[M-1];
        }
        std::cout << save_out << '\n';
        pretty_print (aggregate, M, "chowdsp_wdf");
        ref_time = aggregate.elapsed_ns();
        ref_cycles = aggregate.best.cycles();
    }

    {
        event_aggregate aggregate {};
        float save_out = 0.0f;
        for (int iter = 0; iter < n_iter; ++iter)
        {
            for (int n = 0; n < M; ++n)
                data_in[n] = dist (gen);

            collector.start();
            for (int n = 0; n < M; ++n)
                data_out[n] = process (state, impedances, data_in[n]);

            aggregate << collector.end();
            save_out += data_out[M-1];
        }
        std::cout << save_out << '\n';
        pretty_print (aggregate, M, "wdf_compiler");
        test_time = aggregate.elapsed_ns();
        test_cycles = aggregate.best.cycles();
    }
    std::cout << "wdf_compiler is " << ref_time / test_time << "x faster (time)\n";
    std::cout << "wdf_compiler is " << ref_cycles / test_cycles << "x faster (cycles)\n";

    free (data_in);
    free (data_out);
#endif

    return 0;
}
